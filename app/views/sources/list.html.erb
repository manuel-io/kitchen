<nav>
  <!--
  <%= link_to t(:table_of_contents), list_sources_path %>
  -->
</nav>

<aside id='sources_list'>
  <% if notice %>
  <section class='notice'>
    <p id="notice"><%= notice %></p>
  </section>
  <% end %>
  
  <section>
    <p>
      Dies ist eine Liste mit verweisen auf die Quellen der Rezepte in
      dieser Datenbank. Die Rezepte in dieser Datenbank sind alle vegan.
      Dies muss aber nicht unbedingt auch auf die Rezepte in den Quellen
      zutreffen.
    </p>
  </section>

  <section class='marker'>
    <div class='marker'>
    <% if @published %>
      <%= link_to 'Zeige alle Rezepte', list_sources_path(published: false, query: params['query']) %>
    <% else %>
      <%= link_to 'Zeige Ã¶ffentliche Rezepte', list_sources_path(published: true, query: params['query']) %>
    <% end %>
    </div>
  </section>

  <section class='cloud'>
    <div class='cloud'>
      <% @cloud.each do |value| %>
        <%= image_tag picture_recipe_path(value.id), title: value.title %>
      <% end %>
    </div>
  </section>
</aside>

<article>
  <h2><%= t(:list) %></h2>

  <header class='last'>
    <div class='image'>
      <%= image_tag picture_recipe_path(@last.id) %>
    </div>
    <div class='description'>
      <div>
        <h3><%= @last.title %></h3></center>
        <table>
          <tr>
            <td>
              <%= link_to(t(:click), { action: 'embedded', controller: 'recipes', id: @last.id }, { target: '_blank' }) %>
            </td>
          </tr>
        </table>
        <p><%= @last.description %></p>
        <p><strong><%= t(:price) + ' ' + t(:per_serving) %>:</strong> <%= number_to_currency @last.price_per_serving %></p>
        <p><strong><%= t(:price) + ' ' + t(:in_total) %>:</strong> <%= number_to_currency @last.total %></p>
      </div>
  </div>
  </header>

  <div class='search'>
    <%= form_tag list_sources_path, method: :get do %>
      <p>
        <!--
          not appropriate
          <%= text_field_tag :query, params[:query], placeholder: 'Suche nach Rezepten', onchange: 'this.form.submit()' %>
        -->
        <%= text_field_tag :query, params[:query], placeholder: t(:search_term), autofocus: true %>
        <%= hidden_field_tag 'published', @published %>
        <%= submit_tag t(:search), name: nil %>
      </p>
    <% end %>

    <%= will_paginate @recipes, inner_window: 2, outer_window: 0 %>
  </div>

  <% @recipes.each do |value| %>
    <% if value.sources.length > 0 %>
    <section id='<%= value.id %>'>
      <h3 class='recipe'><%= value.title %></h3>
      <p><%= value.description %></p>
      <p><%= t :serves_in_word, price: number_to_currency(value.price_per_serving), servings: value.serves %></p>
      <% if value.public? %>
        <p><%= t :published %>: <%= link_to(t(:click), { action: 'embedded', controller: 'recipes', id: value.id }, { target: '_blank' }) %></p>
      <% else %>
        <p><%= t :sources %>: <%= value.sources.map { |v| "<span class='source'>" + link_to(v.title, v.url) + "</span>" }.join.html_safe %></p>
      <% end %>
    <% end %>
    </section>
  <% end %>
  <%= will_paginate @recipes, inner_window: 2, outer_window: 0 %>
</article>
