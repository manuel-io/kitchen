<nav>
</nav>

<aside id='sources_list'>
  <% if notice %>
  <section class='notice'>
    <p id="notice"><%= notice %></p>
  </section>
  <% end %>
  
  <section>
    <p>
      Dies ist eine Liste mit verweisen auf die Quellen der Rezepte in
      dieser Datenbank. Die Rezepte in dieser Datenbank sind alle vegan.
      Dies muss aber nicht unbedingt auch auf die Rezepte in den Quellen
      zutreffen.
    </p>
  </section>

  <section>
     <%= form_tag(method: 'get', name: 'pub') do %>
        <%= hidden_field_tag 'query', 'exmaple' %>
       <%= link_to 'Submit', 'javascript: document.pub.submit();' %>
     <% end %>
  </section>

  <section>
    <%= form_tag({controller: 'sources', action: 'list'}, method: 'get', name: 'pub') do %>
      <%= hidden_field_tag 'query', params['query'] %>
      <div class='field'>
        <%= label_tag 'Nur öffentliche Rezepte' do %>
          <%= check_box_tag(:published, 'true', @published) %>
          <%= link_to 'Zeige öffentliche Rezepte', 'javascript: document.pub.submit();' %>
        <% end %>
      </div>
    <% end %>
  </section>
  <!--
  <section>
    <h3>Filter</h3>
    <table>
      <tr>
        <td>
          <ul>
            <li><%= link_to 'Hauptgerichte und Suppen', list_sources_path(tags: 'main,soup') %></li>
            <li><%= link_to 'Hauptgerichte', list_sources_path(tags: 'main') %></li>
            <li><%= link_to 'Nachspeisen', list_sources_path(tags: 'dessert') %></li>
            <li><%= link_to 'Suppen', list_sources_path(tags: 'soup') %></li>
            <li><%= link_to 'Saucen', list_sources_path(tags: 'sauce') %></li>
            <li><%= link_to 'Dips', list_sources_path(tags: 'dip') %></li>
            <li><%= link_to 'Backwaren', list_sources_path(tags: 'bread') %></li>
            <li><%= link_to 'Pflanzenmilch', list_sources_path(tags: 'milk') %></li>
            <li><%= link_to 'Komponenten', list_sources_path(tags: 'ingredient') %></li>
            <li><%= link_to 'Salate', list_sources_path(tags: 'salad') %></li>
          </ul>
        </td>
      </tr>
    </table>
  </section>
  -->
  <section>
    <h3><%= t :format %></h3>
    <table>
      <tr>
        <td>
          <%= link_to 'Markdown', list_sources_path(format: :markdown, page: params['page'], tags: params['tags']) %>
        </td>
      </tr>
      <tr>
        <td>
          <%= link_to t(:text_desc), list_sources_path(format: :text, page: params['page'], tags: params['tags']) %>
        </td>
      </tr>
      <tr>
        <td>
          <%= link_to 'Text', list_sources_path(format: :plain, page: params['page'], tags: params['tags']) %>
        </td>
      </tr>
    </table>
  </section>

  <section>
    <div id='cloud'>
      <% @cloud.each do |value| %>
        <%= image_tag picture_recipe_path(value.id), title: value.title %>
      <% end %>
    </div>
  </section>
</aside>

<article>
  <h2><%= t(:list) %></h2>

  <header class='last'>
    <div class='image'>
      <%= image_tag picture_recipe_path(@last.id) %>
    </div>
    <div class='description'>
      <h3><%= @last.title %></h3></center>
      <table>
        <tr>
          <td>
            <%= link_to(t(:click), { action: 'embedded', controller: 'recipes', id: @last.id }, { target: '_blank' }) %>
          </td>
        </tr>
      </table>
      <p><%= @last.description %></p>
      <p><strong><%= t(:price) + ' ' + t(:per_serving) %>:</strong> <%= number_to_currency @last.price_per_serving %></p>
      <p><strong><%= t(:price) + ' ' + t(:in_total) %>:</strong> <%= number_to_currency @last.total %></p>
    </div>
  </header>

  <div class='search'>
    <%= form_tag list_sources_path, method: :get do %>
      <p>
        <!--
          not appropriate
          <%= text_field_tag :query, params[:query], placeholder: 'Suche nach Rezepten', onchange: 'this.form.submit()' %>
        -->
        <%= text_field_tag :query, params[:query], placeholder: t(:search_term), autofocus: true %>
        <%= hidden_field_tag 'published', @published %>
        <%= submit_tag t(:search), name: nil %>
      </p>
    <% end %>

    <%= will_paginate @recipes, inner_window: 2, outer_window: 0 %>
  </div>

  <% @recipes.each do |value| %>
    <% if value.sources.length > 0 %>
    <section id='<%= value.id %>'>
      <h3 class='recipe'><%= value.title %></h3>
      <p><%= value.description %></p>
      <p><%= t :serves_in_word, price: number_to_currency(value.price_per_serving), servings: value.serves %></p>
      <% if value.public? %>
        <p><%= t :published %>: <%= link_to(t(:click), { action: 'embedded', controller: 'recipes', id: value.id }, { target: '_blank' }) %></p>
      <% else %>
        <p><%= t :sources %>: <%= value.sources.map { |v| "<span class='source'>" + link_to(v.title, v.url) + "</span>" }.join.html_safe %></p>
      <% end %>
    <% end %>
    </section>
  <% end %>
  <%= will_paginate @recipes, inner_window: 2, outer_window: 0 %>
</article>
